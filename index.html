<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/shortfeng/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/shortfeng/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/shortfeng/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/shortfeng/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://killgc.github.io/shortfeng/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/shortfeng/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://killgc.github.io/shortfeng/"/>





  <title>Hexo</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/shortfeng/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/shortfeng/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/shortfeng/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/shortfeng/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/08/06/SpringEL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/08/06/SpringEL/" itemprop="url">SpringEL</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-06T15:51:15+08:00">
                2018-08-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="SpringEL"><a href="#SpringEL" class="headerlink" title="SpringEL"></a>SpringEL</h3><h4 id="与-区别"><a href="#与-区别" class="headerlink" title="${}与#{}区别"></a>${}与#{}区别</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$&#123;key名称&#125;：</span><br><span class="line"><span class="number">1</span>、用户获取外部文件中指定key的值</span><br><span class="line"><span class="number">2</span>、可以出现在xml配置文件中，也可以出现在注解<span class="meta">@Value</span>中</span><br><span class="line"><span class="number">3</span>、获取properties中环境变量</span><br><span class="line"></span><br><span class="line">#&#123;表达式&#125;：</span><br><span class="line"><span class="number">1</span>、SpEL表达式的格式，详情点击[Spring的EL表达式](http:<span class="comment">//blog.csdn.net/u012834750/article/details/79388294)</span></span><br><span class="line"><span class="number">2</span>、可以出现在xml配置文件中，也可以出现在注解<span class="meta">@Value</span>中</span><br><span class="line"><span class="number">3</span>、可以任意表达式，支持运算符等</span><br><span class="line"></span><br><span class="line">在使用的时候也允许#&#123;‘$&#123;key&#125;’&#125;这样使用，比如：</span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"#&#123;'$&#123;jdbc.url&#125;'&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String jdbcUrl;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MQConsumer</span>(consumerGroup = <span class="string">"CONSUMER_DEMO_A"</span>,topic = <span class="string">"TP_DEMO"</span>,tag = <span class="string">"A"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoConsumerA</span> <span class="keyword">extends</span> <span class="title">AbstractMQPushConsumer</span>&lt;<span class="title">Demo</span>&gt;</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">processWithKey</span><span class="params">(String messageKey, Demo message)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DemoConsumerA.processWithKey "</span>+<span class="string">"messageKey=【"</span>+messageKey+<span class="string">"】,message=【"</span>+message+<span class="string">"】"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果想要在配置文件中配置消息消费者的topic及consumerGroup可以按照以下写法：</span><br><span class="line"><span class="meta">@MQConsumer</span>(tag = <span class="string">"A"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoConsumerA</span> <span class="keyword">extends</span> <span class="title">AbstractMQPushConsumer</span>&lt;<span class="title">Demo</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;rocketmq.demoConsumerA.topic&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String topic;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;rocketmq.demoConsumerA.consumerGroup&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String consumerGroup;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">processWithKey</span><span class="params">(String messageKey, Demo message)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"DemoConsumerA.processWithKey "</span>+<span class="string">"messageKey=【"</span>+messageKey+<span class="string">"】,message=【"</span>+message+<span class="string">"】"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//模拟业务处理时间</span></span><br><span class="line">            Thread.sleep(<span class="number">50</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">其中<span class="meta">@Value</span>(<span class="string">"$&#123;rocketmq.demoConsumerA.topic&#125;"</span>)与<span class="meta">@Value</span>(<span class="string">"$&#123;rocketmq.demoConsumerA.consumerGroup&#125;"</span>)对应applicaiton.yml里的如下配置</span><br><span class="line"></span><br><span class="line">rocketmq:</span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  demoConsumerA:</span><br><span class="line">    topic: TP_DEMO</span><br><span class="line">    consumerGroup: CONSUMER_DEMO_A</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/16/中间件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/16/中间件/" itemprop="url">中间件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-16T23:47:45+08:00">
                2018-07-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h3><p>定义：<br>中间件不是最上层的应用，也不是最底层的支撑系统，是处于中间位置的组件。起到桥梁作用，是应用与应用之间的桥梁，也是应用与服务之间的桥梁</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/15/分布式系统理解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/15/分布式系统理解/" itemprop="url">分布式系统理解</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-15T08:36:16+08:00">
                2018-07-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="分布式系统理解"><a href="#分布式系统理解" class="headerlink" title="分布式系统理解"></a>分布式系统理解</h3><h5 id="CAP简介"><a href="#CAP简介" class="headerlink" title="CAP简介"></a>CAP简介</h5><blockquote>
<ul>
<li>C (Consistency) 强一致性<br>系统在执行过某项操作后仍然处于一致的状态。在分布式系统中，更新操作执行成功后所有的用户都应该读到最新的值，这样的系统被认为是具有强一致性的。 等同于所有节点访问同一份最新的数据副本</li>
<li>A (Availability) 可用性<br>每一个操作总是能够在一定的时间内返回结果，这里需要注意的是”一定时间内”和”返回结果”。一定时间指的是，在可以容忍的范围内返回结果，结果可以是成功或者失败</li>
<li>P (Partition tolerance) 分区容忍性<br>理解为在存在网络分区的情况下，仍然可以接受请求（满足一致性和可用性)。这里的网络分区是指由于某种原因，网络被分成若干个孤立的区域，而区域之间互不相通</li>
</ul>
</blockquote>
<h5 id="放弃C-A-P"><a href="#放弃C-A-P" class="headerlink" title="放弃C.A.P"></a>放弃C.A.P</h5><p>   放弃P：如果想避免分区容错性问题的发生，一种做法是将所有的数据（与事务相关的）都放在一台机器上。虽然无法100%保证系统不会出错，但不会碰到由分区带来的负面效果。当然这个选择会严重的影响系统的扩展性。</p>
<p>　　放弃A:相对于放弃“分区容错性“来说，其反面就是放弃可用性。一旦遇到分区容错故障，那么受到影响的服务需要等待一定的时间，因此在等待期间系统无法对外提供服务。</p>
<p>　　放弃C：这里所说的放弃一致性，并不是完全放弃数据一致性，而是放弃数据的强一致性，而保留数据的最终一致性。以网络购物为例，对只剩下一件库存的商品，如果同时接受到了两份订单，那么较晚的订单将被告知商品告罄。</p>
<p>　　一致性与可用性的决择： 而CAP理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络硬件肯定 会出现延迟丢包等问题，所以分区容忍性是我们必须需要实现的。所以我们只能在一致性和可用 性之间进行权衡</p>
<h5 id="流行解释"><a href="#流行解释" class="headerlink" title="流行解释"></a>流行解释</h5><p>　　目前流行的、对CAP理论解释的情形是从同一数据在网络环境中存在多个副本出发为前提的。为了保证数据不会丢失，同时也是为了增加并发访问量（读写分离），在企业级的数据管理方案中，一般必须考虑数据的冗余存储问题，而这应该是通过在网络上的其他独立物理存储节点上保留另一份、或多份数据副本来实现的（如附图所示）。因为在同一个存储节点上的数据冗余明显不能解决单点故障问题，这与通过多节点集群来提供更好的计算可用性的道理是相同的。</p>
<p>　　如上图的情况，数据在节点A、B、C上保留了三份，如果对节点A上的数据进行了修改，然后再让客户端通过网络对该数据进行读取。那么，客户端的读取操作什么时候返回呢？</p>
<p>　　一种情况是要求节点A、B、C的三份数据完全一致后返回。也就是说，这时从任何一个网络节点读取的数据都是一样的，这就是所谓的强一致性读。很明显，这时数据读取的Latency要高一些（因为要等数据在网络中的复制），同时A、B、C三个节点中任何一个宕机，都会导致数据不可用。也就是说，要保证强一致性，网络中的副本越多，数据的可用性就越差。</p>
<p>　　另一种情况是，允许读操作立即返回，容忍B节点的读取与A节点的读取不一致的情况发生。这样一来，可用性显然得到了提高，网络中的副本也可以多一些，唯一得不到保证的是数据一致性。当然，对写操作同样也有多个节点一致性的情况，在此不再赘述。</p>
<p>　　可以看出，上述对CAP理论的解释主要是从网络上多个节点之间的读写一致性出发考虑问题的。而这一点，对于关系型数据库意味着什么呢？当然主要是指通常所说的Standby（关于分布式事务，涉及到更多考虑，随后讨论）情况。对此，在实践中我们大多已经采取了弱一致性的异步延时同步方案，以提高可用性。这种情况并不存在关系型数据库为保证C、A而放弃P的情况；而对海量数据管理的需求，关系型数据库扩展过程中所遇到的性能瓶颈，似乎也并不是CAP理论中所描述的那种原因造成的。那么，上述流行的说法中所描述的关系型数据库为保证C、A而牺牲P到底是在指什么呢？ 如果只将CAP当作分布式系统中多个数据副本之间的读写一致性问题的通用理论对待，那么就可以得出结论：CAP既适用于NoSQL数据库，也适用于关系型数据库。它是NoSQL数据库、关系型数据库，乃至一切分布式系统在设计数据多个副本之间读写一致性问题时需要遵循的共同原则。</p>
<p><img src="https://images0.cnblogs.com/blog2015/387014/201503/312030383574823.jpg" alt="cmd-markdown-logo"></p>
<p>关于对CAP理论中一致性C的理解，除了上述数据副本之间的读写一致性以外，分布式环境中还有两种非常重要的场景，如果不对它们进行认识与讨论，就永远无法全面地理解CAP，当然也就无法根据CAP做出正确的解释。</p>
<h5 id="分布式场景"><a href="#分布式场景" class="headerlink" title="分布式场景"></a>分布式场景</h5><p>　　1.分布式环境中的事务场景      </p>
<p>　　我们知道，在关系型数据库的事务操作遵循ACID原则，其中的一致性C，主要是指一个事务中相关联的数据在事务操作结束后是一致的。所谓ACID原则，是指在写入/异动资料的过程中，为保证交易正确可靠所必须具备的四个特性：即原子性（Atomicity，或称不可分割性）、一致性（Consistency）、隔离性（Isolation，又称独立性）和持久性（Durability）。</p>
<p>　　例如银行的一个存款交易事务，将导致交易流水表增加一条记录。同时，必须导致账户表余额发生变化，这两个操作必须是一个事务中全部完成，保证相关数据的一致性。而前文解释的CAP理论中的C是指对一个数据多个备份的读写一致性。表面上看，这两者不是一回事，但实际上，却是本质基本相同的事物：数据请求会等待多个相关数据操作全部完成才返回。对分布式系统来讲，这就是我们通常所说的分布式事务问题。</p>
<p>　　众所周知，分布式事务一般采用两阶段提交策略来实现，这是一个非常耗时的复杂过程，会严重影响系统效率，在实践中我们尽量避免使用它。在实践过程中，如果我们为了扩展数据容量将数据分布式存储，而事务的要求又完全不能降低。那么，系统的可用性一定会大大降低，在现实中我们一般都采用对这些数据不分散存储的策略。</p>
<p>　　当然，我们也可以说，最常使用的关系型数据库，因为这个原因，扩展性（分区可容忍性P）受到了限制，这是完全符合CAP理论的。但同时我们应该意识到，这对NoSQL数据库也是一样的。如果NoSQL数据库也要求严格的分布式事务功能，情况并不会比关系型数据库好多少。只是在NoSQL的设计中，我们往往会弱化甚至去除事务的功能，该问题才表现得不那么明显而已。</p>
<p>　　因此，在扩展性问题上，如果要说关系型数据库是为了保证C、A而牺牲P，在尽量避免分布式事务这一点上来看，应该是正确的。也就是说：关系型数据库应该具有强大的事务功能，如果分区扩展，可用性就会降低；而NoSQL数据库干脆弱化甚至去除了事务功能，因此，分区的可扩展性就大大增加了。</p>
<p>　　2.分布式环境中的关联场景      </p>
<p>　　初看起来，关系型数据库中常用的多表关联操作与CAP理论就更加不沾边了。但仔细考虑，也可以用它来解释数据库分区扩展对关联所带来的影响。对一个数据库来讲，采用了分区扩展策略来扩充容量，数据分散存储了，很显然多表关联的性能就会下降，因为我们必须在网络上进行大量的数据迁移操作，这与CAP理论中数据副本之间的同步操作本质上也是相同的。</p>
<p>　　因此，如果要保证系统的高可用性，需要同时实现强大的多表关系操作的关系型数据库在分区可扩展性上就遇到了极大的限制（即使是那些采用了各种优秀解决方案的MPP架构的关系型数据库，如TeraData，Netezza等，其水平可扩展性也是远远不如NoSQL数据库的），而NoSQL数据库则干脆在设计上弱化甚至去除了多表关联操作。那么，从这一点上来理解”NoSQL数据库是为了保证A与P，而牺牲C”的说法，也是可以讲得通的。当然，我们应该理解，关联问题在很多情况下不是并行处理的优点所在，这在很大程度上与Amdahl定律相符合。</p>
<p>　　所以，从事务与关联的角度来看关系型数据库的分区可扩展性为什么受限的原因是最为清楚的。而NoSQL数据库也正是因为弱化，甚至去除了像事务与关联（全面地讲，其实还有索引等特性）等在分布式环境中会严重影响系统可用性的功能，才获得了更好的水平可扩展性。</p>
<p>　　那么，如果将事务与关联也纳入CAP理论中一致性C的范畴的话，问题就很清楚了：关于“关系型数据库为了保证一致性C与可用性A，而不得不牺牲分区可容忍性P”的说法便是正确的了。但关于”NoSQL选择了C与P，或者A与P”的说法则是错误的，所有的NoSQL数据库在设计策略的大方向上都是选择了A与P（虽然对同一数据多个副本的读写一致性问题的设计各有不同），从来没有完全选择C与P的情况存在。</p>
<p>　　现在看来，如果理解CAP理论只是指多个数据副本之间读写一致性的问题，那么它对关系型数据库与NoSQL数据库来讲是完全一样的，它只是运行在分布式环境中的数据管理设施在设计读写一致性问题时需要遵循的一个原则而已，却并不是NoSQL数据库具有优秀的水平可扩展性的真正原因。而如果将CAP理论中的一致性C理解为读写一致性、事务与关联操作的综合，则可以认为关系型数据库选择了C与A，而NoSQL数据库则全都是选择了A与P，但并没有选择C与P的情况存</p>
<p>CAP理论是指多个数据副本之间读写一致性的问题</p>
<p>CAP理论中的一致性C理解为读写一致性、事务与关联操作的综合，则可以认为关系型数据库选择了C与A，而NoSQL数据库则全都是选择了A与P，但并没有选择C与P的情况存在</p>
<p>对于一致性，可以分为从客户端和服务端两个不同的视角。从客户端来看，一致性主要指的是多并发访问时更新过的数据如何获取的问题。从服务端来看，则是更新如何复制分布到整个系统，以保证数据最终一致。一致性是因为有并发读写才有的问题，因此在理解一致性的问题时，一定要注意结合考虑并发读写的场景</p>
<p>传统的关系型数据库在功能支持上通常很宽泛，从简单的键值查询，到复杂的多表联合查询再到事务机制的支持。而与之不同的是，NoSQL系统通常注重性能和扩展性，而非事务机制（事务就是强一致性的体现）</p>
<p>对于分布式数据系统： N — 数据复制的份数,W — 更新数据是需要保证写完成的节点数,R — 读取数据的时候需要读取的节点数如果W+R&gt;N，写的节点和读的节点重叠，则是强一致性。例如对于典型的一主一备同步复制的关系型数据库，N=2,W=2,R=1，则不管读的是主库还是备库的数据，都是一致的。 如果W+R&lt;=N，则是弱一致性。例如对于一主一备异步复制的关系型数据库，N=2,W=1,R=1，则如果读的是备库，就可能无法读取主库已经更新过的数据，所以是弱一致性。 对于分布式系统，为了保证高可用性，一般设置N&gt;=3。不同的N,W,R组合，是在可用性和一致性之间取一个平衡，以适应不同的应用场景。 如果N=W,R=1，任何一个写节点失效，都会导致写失败，因此可用性会降低，但是由于数据分布的N个节点是同步写入的，因此可以保证强一致性。如果N=R,W=1，只需要一个节点写入成功即可，写性能和可用性都比较高。但是读取其他节点的进程可能不能获取更新后的数据，因此是弱一致性。这种情况下，如果W&lt;(N+1)/2，并且写入的节点不重叠的话，则会存在写冲突。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/08/java面试题第五套/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/08/java面试题第五套/" itemprop="url">java面试题第五套</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-08T22:05:38+08:00">
                2018-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java面试题第五套"><a href="#java面试题第五套" class="headerlink" title="java面试题第五套"></a>java面试题第五套</h3><p>一、Java相关</p>
<p>乐观悲观锁的设计，如何保证原子性，解决的问题；</p>
<p>char和double的字节，以及在内存的分布是怎样；</p>
<p>对象内存布局，然后讲下对象的死亡过程？</p>
<p>对象头，详细讲下；</p>
<p>sync原理详细，sync内抛异常会怎样，死锁吗？还是释放掉？怎么排查死锁？死锁会怎样？有没有什么更好的替代方案？</p>
<p>详细讲一下集合，HashSet源码，HashMap源码，如果要线程安全需要怎么做？</p>
<p>多线程是解决什么问题的？线程池解决什么问题？</p>
<p>线程池，如何设计的，里面的参数有多少种，里面的工作队列和线程队列是怎样的结构，如果给你，怎样设计线程池？</p>
<p>AQS原理，ReentranLock源码，设计原理，整体过程。</p>
<p>继续聊多线程源码，sync原理，然后一个场景设计题；</p>
<p>float f = 1.4f;double d = 1.4d; 与 float f = 1.5f;double d = 1.5d; 是否为true，内存是怎样的；</p>
<p>split的源码，split(“a|b|c”);得出多少个数组；</p>
<p>把所有认识熟用的JUC( java.util.concurrent(简称JUC)包)下的类写出来，讲下使用，然后讲下原生的线程操作;</p>
<p>开闭原则，解析工厂方法模式，建造者模式，区别。手撸出来。</p>
<p>讲下JVM的大页模式，JVM内存模型;</p>
<p>什么是敏捷开发，防御性编程，并行编程。Team Leader的思考;</p>
<p>逃逸分析是什么，作用是什么，用途是什么;</p>
<p>怎么认为一个类是线程安全？线程安全的定义是什么？Java有多少个关键字进行同步？为什么这样设计？（聊了一大堆，一堆为什么）；</p>
<p>两个线程设计题。记得一个是：t1,t2,t3，让t1，t2执行完才执行t3，原生实现。</p>
<p>写个后缀表达式，为什么要设计后缀表达式，有什么好处？然后写下中缀。</p>
<p>我看你做过性能优化，比如你怎么分析项目里面的OOM的，内存泄露呢？详细说思路;</p>
<p>说下多线程，我们什么时候需要分析线程数，怎么分析，分析什么因素;</p>
<p>抽象方法和类方法的区别，static的抽象方法可以吗？</p>
<p>说下Java的克隆体系;</p>
<p>涉及OOM、JVM优化、源码问题、数据库优化、多线程等问题;</p>
<p>CPU高？什么情况CPU高？解决什么问题？</p>
<p>你有遇到过临界区问题吗？有遇到过吗？你在项目遇到这个问题是怎样解决的？</p>
<p>volatile关键字作用;</p>
<p>Java的多态怎么实现;</p>
<p>解释一下自旋;</p>
<p>解释一下信号量;</p>
<p>什么情况下会触发类加载；</p>
<p>Java内存抖动严重，优化的思路；</p>
<p>二、数据库相关</p>
<p>SQL优化思路，联合索引与底层树结构的映像关系，索引结构（B+、B-），为什么用这样的结构；</p>
<p>讲下MySQL的集群？集群遇到过什么问题？sql的优化？</p>
<p>你目前为止遇到的最大数据量是多少？知道100万时候怎么设计吗？1000万呢？过几十亿呢？</p>
<p>MySQL有多少个参数可调，除了最大连接数。全部列出来，一个个分析。</p>
<p>聊下优化过的索引，怎么优化;</p>
<p>红黑树和平衡树的区别，为什么数据库不用红黑树;</p>
<p>mysql有哪些锁，意向锁有什么用;</p>
<p>数据库高并发下的优化思路;</p>
<p>数据库什么情况下索引会失效;</p>
<p>三、数据结构和操作系统相关</p>
<p>数据结构学过吧，聊一下？学过什么结构？讲下树和队列？B树呢？</p>
<p>操作系统学过吧，聊一下？讲一下系统内存是怎样的？分段分页虚拟内存？</p>
<p>页面置换算法呢？多少种？有最优的置换算法吗？</p>
<p>你学过什么课程？然后聊下操作系统，内核、用户之类。</p>
<p>反转链表手撸;</p>
<p>快排，给一串数组，把具体每次patition写下，最终结果也写45, 32, 41, 35, 38, 20, 50;</p>
<p>一个整数status, 判断第K个比特位是否为比特1;</p>
<p>把递归实现的快排改成非递归，你知道非递归有什么好处吗;</p>
<p>举例使用分治思想的算法;</p>
<p>四、网络相关</p>
<p>讲下请求头细节？</p>
<p>Http和Https？Http1.0,1.1,2.0，讲下长连接和短连接？Https是怎样的？如果我篡改了公钥呢？怎么防止？</p>
<p>Get和Post，讲下区别，要我模拟出抓包来。</p>
<p>详细讲下Cookie和Session，Token，OAuth2.0协议;</p>
<p>拥塞算法知道吗？哪些，分别怎样？</p>
<p>学过计算机网络是吧？socket熟悉吗？对它的读写缓冲区有理解吗？怎么的？那滑动窗口是怎样的？为什么这样设计？</p>
<p>再聊下Http的Http basic authentication;</p>
<p>Https的过程;</p>
<p>五、框架相关</p>
<p>聊下Spring源码，知道多少，都聊一下；</p>
<p>聊下Spring注解，@Autowire，@Resource，以及他们的解析过程；</p>
<p>聊一下架构，接入层架构，服务层架构。聊下技术栈，Spring Boot，Spring Cloud、Docker；</p>
<p>Spring ioc的具体优势，和直接New一个对象有什么区别;</p>
<p>Servlet生命周期，是否单例，为什么是单例;</p>
<p>Spring Mvc初始化过程；</p>
<p>五、分布式相关</p>
<p>多少种RPC框架？</p>
<p>一致性哈希是干嘛的？</p>
<p>搭建高并发高可用系统需要怎样设计？考虑哪些东西，有多少说多少。</p>
<p>你对缓存有什么理解？缓存是解决什么问题？后端缓存有哪些，分别解决什么问题？</p>
<p>聊一下分布式锁；</p>
<p>你是怎么设计系统缓存的，为什么，什么场景；</p>
<p>也来说下，削峰的多种实现，Redis？MQ？</p>
<p>为什么用mq就能削峰？解决什么问题？</p>
<p>六、设计题</p>
<p>有几台机器存储着几亿淘宝搜索日志，你只有一台2g的电脑，怎么选出搜索热度最高的十个搜索关键词;</p>
<p>如何设计算法压缩一段URL;</p>
<p>有一个页面能同时展示两个广告，现在有五个广告，设计算法使五个广告展示概率为1:2:3:4:5；</p>
<p>有25匹马，五个赛道，用最少比赛次数将25匹马排序；</p>
<p>七、其他相关</p>
<p>Tomcat缓存，聊下缓存的整体理解，知道多少种缓存；</p>
<p>解释下Mucene原理，倒排索引，怎样进行中文分词，基于什么进行分词；</p>
<p>TopN的大数据量题；</p>
<p>你对接入层要思考什么东西？遇到过哪些问题？搭建系统要考量哪些因素？</p>
<p>然后项目问题，优化问题；</p>
<p>熟悉maven是吧？我们来聊下Maven的源码原理，Maven冲突的时候，怎么选择依赖包，我们怎么查，我们遇到两个不一样的版本，我们应该如何去选择，为什么？</p>
<p>项目如何分组，性能优化小组应该做哪些;</p>
<p>我们来说下接入层的搭建，认知分析;</p>
<p>问下项目的系统构建，思考，为什么这样构建？</p>
<p>如何判断一段代码的好坏;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/08/java面试题第四套/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/08/java面试题第四套/" itemprop="url">java面试题第四套</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-08T22:04:53+08:00">
                2018-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java面试题第四套"><a href="#java面试题第四套" class="headerlink" title="java面试题第四套"></a>java面试题第四套</h3><p>一、Java基础</p>
<p>为什么JVM调优经常会将-Xms和-Xmx参数设置成一样；</p>
<p>Java线程池的核心属性以及处理流程；</p>
<p>Java内存模型，方法区存什么；</p>
<p>CMS垃圾回收过程；</p>
<p>Full GC次数太多了，如何优化；</p>
<p>直接内存如何管理的；</p>
<p>Java线程池的几个参数的意义和实现机制；</p>
<p>Java线程池使用无界任务队列和有界任务队列的优劣对比；</p>
<p>CountDownLatch和CyclicBarrier的区别；</p>
<p>Java中有哪些同步方案（重量级锁、显式锁、并发容器、并发同步器、CAS、volatile、AQS等）</p>
<p>如果你的项目出现了内存泄露，怎么监控这个问题呢；</p>
<p>标记清除和标记整理的区别和优缺点，为何标记整理会发生stop the world；</p>
<p>线程池，如何根据CPU的核数来设计线程大小，如果是计算机密集型的呢，如果是IO密集型的呢？</p>
<p>让你设计一个cache如何设计；</p>
<p>String中hashcode是怎么实现的；</p>
<p>JDK中哪些实现了单例模式？</p>
<p>多个线程同时读写，读线程的数量远远⼤于写线程，你认为应该如何解决并发的问题？你会选择加什么样的锁？</p>
<p>线程池内的线程如果全部忙，提交⼀个新的任务，会发⽣什么？队列全部塞满了之后，还是忙，再提交会发⽣什么？</p>
<p>synchronized关键字锁住的是什么东西？在字节码中是怎么表示的？在内存中的对象上表现为什么？</p>
<p>wait/notify/notifyAll⽅法需不需要被包含在synchronized块中？这是为什么？</p>
<p>ExecutorService你一般是怎么⽤的？是每个Service放一个还是个项目放一个？有什么好处？</p>
<p>二、数据库</p>
<p>InnoDB的插入缓冲和两次写的概率和意义；</p>
<p>如果建了⼀个单列索引，查询的时候查出2列，会⽤到这个单列索引吗？（会用到）</p>
<p>如果建了⼀个包含多个列的索引，查询的时候只⽤了第⼀列，能不能⽤上这个索引？查三列呢？</p>
<p>接上题，如果where条件后⾯带有⼀个 i + 5 &lt; 100 会使⽤到这个索引吗？</p>
<p>like %aaa%会使⽤索引吗? like aaa%呢?</p>
<p>drop、truncate、delete的区别？</p>
<p>平时你们是怎么监控数据库的? 慢SQL是怎么排查的？（慢查询日志）</p>
<p>你们数据库是否⽀持emoji表情，如果不⽀持，如何操作?选择什么编码方式？如果支持一个表情占几个字节?(utf8mb4)；</p>
<p>如果查询很慢，你会想到的第⼀个⽅式是什么？（数据库索引）</p>
<p>三、Linux基础</p>
<p>Linux下可以在/proc目录下可以查看CPU的核心数等；cat /proc/下边会有很多系统内核信息可供显示； </p>
<p>说一下栈的内存是怎么分配的；</p>
<p>Linux各个目录有了解过吗？/etc、/bin、/dev、/lib、/sbin这些常见的目录主要作用是什么？</p>
<p>说一下栈帧的内存是怎么分配的；</p>
<p>Linux下排查某个死循环的线程；</p>
<p>动态链接和静态链接的区别；</p>
<p>进程的内存分布；</p>
<p>如何查找一个进程打开所有的文件；</p>
<p>说一下常使用的协议及其对应的端口；</p>
<p>为什么会有内核态，保护模式你知道吗?</p>
<p>文件是怎么在磁盘上存储的？</p>
<p>有了进程为何还要线程呢，不同进程和线程他们之间有什么不同。（进程是资源管理的最小单位，线程是程序执行的最小单位。在操作系统设计上，从进程演化出线程，最主要的目的就是更好的支持SMP以及减小（进程/线程）上下文切换开销。）</p>
<p>InnoDB聚集索引B+树叶子节点和磁盘什么顺序相同;</p>
<p>文件系统，进程管理和调度，内存管理机制、虚地址保护模式；</p>
<p>四、网络基础</p>
<p>HTTP1.0和HTTP1.1的区别；</p>
<p>DHCP如何实现分配IP的； 发现阶段（DHCP客户端在网络中广播发送DHCP DISCOVER请求报文，发现DHCP服务器，请求IP地址租约）、提供阶段（DHCP服务器通过DHCP OFFER报文向DHCP客户端提供IP地址预分配）、选择阶段（DHCP客户端通过DHCP REQUEST报文确认选择第一个DHCP服务器为它提供IP地址自动分配服务）和确认阶段（被选择的DHCP服务器通过DHCP ACK报文把在DHCP OFFER报文中准备的IP地址租约给对应DHCP客户端）。</p>
<p>OSI七层模型，每层都说下自己的理解和知道的，说的越多越好；</p>
<p>五、框架相关</p>
<p>Servlet如何保证单例模式,可不可以编程多例的哪？</p>
<p>Dubbo请求流程以及原理；</p>
<p>Spring框架如何实现事务的；</p>
<p>如果一个接⼝有2个不同的实现, 那么怎么来Autowire一个指定的实现？(可以使用Qualifier注解限定要注入的Bean，也可以使用Qualifier和Autowire注解指定要获取的bean，也可以使用Resource注解的name属性指定要获取的Bean)</p>
<p>Spring框架中需要引用哪些jar包，以及这些jar包的用途；</p>
<p>Spring Boot没有放到web容器⾥为什么能跑HTTP服务？</p>
<p>Spring中循环注入是什么意思，可不可以解决，如何解决；</p>
<p>Spring的声明式事务 @Transaction注解⼀般写在什么位置? 抛出了异常会⾃动回滚吗？有没有办法控制不触发回滚?</p>
<p>MyBatis怎么防止SQL注入；</p>
<p>Tomcat本身的参数你⼀般会怎么调整？</p>
<p>了解哪几种序列化协议？如何选择合适的序列化协议；</p>
<p>Redis渐进式rehash过程？</p>
<p>比如我有个电商平台，做每日订单的异常检测，服务端代码应该写；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/08/java面试题第三套/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/08/java面试题第三套/" itemprop="url">java面试题第三套</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-08T22:03:56+08:00">
                2018-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java面试题第三套"><a href="#java面试题第三套" class="headerlink" title="java面试题第三套"></a>java面试题第三套</h3><p>一、基础题</p>
<p>怎么解决Hash冲突；（开放地址法、链地址法、再哈希法、建立公共溢出区等）</p>
<p>写出一个必然会产生死锁的伪代码；</p>
<p>Spring IoC涉及到的设计模式；（工厂模式、单利模式。。）</p>
<p>toString()方法什么情况下需要重写；</p>
<p>判断对象相等时，什么情况下只需要重写 equals()，什么情况下需要重写 equals(),hashcode()？</p>
<p>Set内存放的元素为什么不可以重复，内部是如何保证和实现的？</p>
<p>如何保证分布式缓存的一致性(分布式缓存一致性hash算法?)？分布式session实现？</p>
<p>Java 8流式迭代的好处？</p>
<p>项目中用到的JDK的哪些特性？</p>
<p>说一下TreeMap的实现原理？红黑树的性质？红黑树遍历方式有哪些？如果key冲突如何解决？setColor()方法在什么时候用？什么时候会进行旋转和颜色转换？</p>
<p>Spring的bean的创建时机？依赖注入的时机？</p>
<p>ArrayList和LinkList的删除一个元素的时间复杂度；（ArrayList是O(N)，LinkList是O(1)）；</p>
<p>CopyOnWriteArrayList是什么；</p>
<p>序列化和反序列化底层如何实现的（ObjectOutputStream 、ObjectInputStream、 readObject  writeObject）；</p>
<p>如何调试多线程的程序；</p>
<p>一个线程连着调用start两次会出现什么情况？（由于状态只有就绪、阻塞、执行，状态是无法由执行转化为执行的，所以会报不合法的状态！）</p>
<p>HashMap在什么时候时间复杂度是O（1），什么时候是O（n），什么时候又是O（logn）；</p>
<p>wait方法能不能被重写？（wait是final类型的，不可以被重写，不仅如此，notify和notifyall都是final类型的），wait能不能被中断；</p>
<p>一个Controller调用两个Service，这两Service又都分别调用两个Dao，问其中用到了几个数据库连接池的连接？</p>
<p>二、网络基础</p>
<p>HTTP、TCP、UDP的区别和联系；</p>
<p>TCP和UDP各自的优势，知道哪些使用UDP协议的成功案例；</p>
<p>TCP和UDP各用了底层什么协议；</p>
<p>单个UDP报文最大容量；</p>
<p>单个TCP报文最大容量；</p>
<p>TCP报头格式、UDP报头格式；</p>
<p>Server遭遇SYN Flood应当怎么处理；</p>
<p>Web开发中如何防范XSS？</p>
<p>拆包和粘包的问题，如何解决，如果我们的包没有固定长度的话，我们的应用程序应该如何解决；</p>
<p>三、操作系统</p>
<p>为什么要内存对齐；</p>
<p>为什么会有大端小端，htol这一类函数的作用；</p>
<p>top显示出来的系统信息都是什么含义；（重要！）</p>
<p>Linux地址空间，怎么样进行寻址的；</p>
<p>Linux如何查找目录或者文件的；</p>
<p>四、分布式其他</p>
<p>分库与分表带来的分布式困境与应对之策；</p>
<p>Solr如何实现全天24小时索引更新；</p>
<p>五、Redis</p>
<p>Redis插槽的分配（key的有效部分使用CRC16算法计算出哈希值，再将哈希值对16384取余，得到插槽值）;</p>
<p>Redis主从是怎么选取的（一种是主动切换，另一种是使用sentinel自动方式）;</p>
<p>Redis复制的过程;</p>
<p>Redis队列应用场景；</p>
<p>Redis主节点宕机了怎么办，还有没有同步的数据怎么办;</p>
<p>六、系统设计开放性题目</p>
<p>秒杀系统设计，超卖怎么搞;</p>
<p>你们的图片时怎么存储的，对应在数据库中时如何保存图片的信息的？</p>
<p>假如成都没有一座消防站，现在问你要建立几座消防站，每个消防站要配多少名消防官兵，多少辆消防车，请你拿出一个方案；</p>
<p>基于数组实现一个循环阻塞队列；</p>
<p>常见的ipv4地址的展现形式如“168.0.0.1”，请实现ip地址和int类型的相互转换。（使用位移的方式）</p>
<p>现网某个服务部署在多台Liunx服务器上，其中一台突然出现CPU 100%的情况，而其他服务器正常，请列举可能导致这种情况发生的原因？如果您遇到这样的情况，应如何定位？内存？CPU？发布？debug？请求量？</p>
<p>七、大数据量问题（后边会有专题单独讨论）</p>
<p>给定a、b两个文件，各存放50亿个url，每个url各占64字节，内存限制是4G，让你找出a、b文件共同的url？</p>
<p>海量日志数据，提取出某日访问百度次数最多的那个IP；</p>
<p>一个文本文件，大约有一万行，每行一个词，要求统计出其中最频繁出现的前10个词，请给出思想，给出时间复杂度分析。</p>
<p>此话题后边会有专门的文章探讨，如果有等不及的小伙伴，可以移步参考：</p>
<p>1、<a href="https://blog.csdn.net/v_july_v/article/details/6279498" target="_blank" rel="noopener">https://blog.csdn.net/v_july_v/article/details/6279498</a></p>
<p>2、<a href="https://blog.csdn.net/v_july_v/article/details/7382693" target="_blank" rel="noopener">https://blog.csdn.net/v_july_v/article/details/7382693</a></p>
<p>八、逻辑思维题</p>
<p>有两根粗细均匀的香（烧香拜佛的香），每一根烧完都花一个小时，怎么样能够得到15min？</p>
<p>假定你有8个撞球，其中有1个球比其他的球稍重,如果只能利用天平来断定哪一个球重,要找到较重的球,要称几次?（2次）；</p>
<p>实验室里有1000个一模一样的瓶子，但是其中的一瓶有毒。可以用实验室的小白鼠来测试哪一瓶是毒药。如果小白鼠喝掉毒药的话，会在一个星期的时候死去，其他瓶子里的药水没有任何副作用。请问最少用多少只小白鼠可以在一个星期以内查出哪瓶是毒药；（答案是10只）</p>
<p>假设有一个池塘，里面有无穷多的水。现有2个空水壶，容积分别为5升和6升。问题是如何只用这2个水壶从池塘里取得3升的水；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/08/java面试题第二套/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/08/java面试题第二套/" itemprop="url">java面试题第二套</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-08T22:02:06+08:00">
                2018-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java面试题第二套"><a href="#java面试题第二套" class="headerlink" title="java面试题第二套"></a>java面试题第二套</h3><p>一、Java相关</p>
<p>Arraylist与LinkedList默认空间是多少；</p>
<p>Arraylist与LinkedList区别与各自的优势List 和 Map 区别；</p>
<p>谈谈HashMap，哈希表解决hash冲突的方法；</p>
<p>为什么要重写hashcode()和equals()以及他们之间的区别与关系；</p>
<p>Object的hashcode()是怎么计算的？</p>
<p>若hashcode方法永远返回1或者一个常量会产生什么结果？</p>
<p>Java Collections和Arrays的sort方法默认的排序方法是什么；</p>
<p>引用计数法与GC Root可达性分析法区别；</p>
<p>浅拷贝和深拷贝的区别；</p>
<p>String s=”abc”和String s=new String(“abc”)区别；</p>
<p>HashSet方法里面的hashcode存在哪，如果重写equals不重写hashcode会怎么样？</p>
<p>反射的作用与实现原理；</p>
<p>Java中的回调机制；</p>
<p>模板方法模式；</p>
<p>开闭原则说一下；</p>
<p>发布/订阅使用场景；</p>
<p>KMP算法（一种改进的字符串匹配算法）；</p>
<p>JMM里边的原子性、可见性、有序性是如何体现出来的，JMM中内存屏障是什么意思，</p>
<p>二、多线程</p>
<p>AtomicInteger底层实现原理；</p>
<p>synchronized与ReentraLock哪个是公平锁；</p>
<p>CAS机制会出现什么问题；</p>
<p>用过并发包下边的哪些类；</p>
<p>一个线程连着调用start两次会出现什么情况？</p>
<p>wait方法能不能被重写，wait能不能被中断；</p>
<p>线程池的实现？四种线程池？重要参数及原理？任务拒接策略有哪几种？</p>
<p>线程状态以及API怎么操作会发生这种转换；</p>
<p>常用的避免死锁方法；</p>
<p>三、JVM</p>
<p>Minor GC与Full GC分别在什么时候发生？什么时候触发Full GC;</p>
<p>GC收集器有哪些？CMS收集器与G1收集器的特点。</p>
<p>Java在什么时候会出现内存泄漏；</p>
<p>Java中的大对象如何进行存储；</p>
<p>rt.jar被什么类加载器加载，什么时间加载；</p>
<p>自己写的类被什么加载，什么时间加载；</p>
<p>自己写的两个不同的类是被同一个类加载器加载的吗？为什么？</p>
<p>为什么新生代内存需要有两个Survivor区？</p>
<p>几种常用的内存调试工具：jmap、jstack、jconsole；</p>
<p>类加载的五个过程：加载、验证、准备、解析、初始化；</p>
<p>G1停顿吗，CMS回收步骤，CMS为什么会停顿，停顿时间；</p>
<p>栈主要存的数据是什么，堆呢？</p>
<p>堆分为哪几块，比如说新生代老生代，那么新生代又分为什么？</p>
<p>软引用和弱引用的使用场景（软引用可以实现缓存，弱引用可以用来在回调函数中防止内存泄露）；</p>
<p>四、数据库</p>
<p>数据库索引，什么是全文索引，全文索引中的倒排索引是什么原理；</p>
<p>数据库最佳左前缀原则是什么？</p>
<p>数据库的三大范式；</p>
<p>悲观锁和乐观锁的原理和应用场景；</p>
<p>左连接、右连接、内连接、外连接、交叉连接、笛卡儿积等；</p>
<p>一般情况下数据库宕机了如何进行恢复（什么是Write Ahead Log机制，什么是Double Write机制，什么是Check Point）；</p>
<p>什么是redo日志、什么是undo日志；</p>
<p>数据库中的隔离性是怎样实现的；原子性、一致性、持久性又是如何实现的；</p>
<p>什么是组合索引，组合索引什么时候会失效；</p>
<p>关系型数据库和非关系型数据库区别；</p>
<p>数据库死锁如何解决；</p>
<p>MySQL并发情况下怎么解决（通过事务、隔离级别、锁）；</p>
<p>MySQL中的MVCC机制是什么意思，根据具体场景，MVCC是否有问题；</p>
<p>MySQL数据库的隔离级别，以及如何解决幻读；</p>
<p>五、缓存服务器</p>
<p>Redis中zSet跳跃表问题；</p>
<p>Redis的set的应用场合？</p>
<p>Redis高级特性了解吗？</p>
<p>Redis的pipeline有什么用处？</p>
<p>Redis集群宕机如何处理，怎么样进行数据的迁移；</p>
<p>Redis的集群方案；</p>
<p>Redis原子操作怎么用比较好；</p>
<p>Redis过期策略是怎么实现的呢？</p>
<p>六、SSM相关</p>
<p>Spring中@Autowired和@Resource注解的区别？</p>
<p>Spring声明一个 bean 如何对其进行个性化定制；</p>
<p>MyBatis有什么优势；</p>
<p>MyBatis如何做事务管理；</p>
<p>七、操作系统</p>
<p>Linux静态链接和动态链接；</p>
<p>什么是IO多路复用模型（select、poll、epoll）；</p>
<p>Linux中的grep管道用处？Linux的常用命令？</p>
<p>操作系统中虚拟地址、逻辑地址、线性地址、物理地址的概念及区别；</p>
<p>内存的页面置换算法；</p>
<p>内存的页面置换算法；</p>
<p>进程调度算法，操作系统是如何调度进程的；</p>
<p>父子进程、孤儿进程、僵死进程等概念；</p>
<p>fork进程时的操作；</p>
<p>kill用法，某个进程杀不掉的原因（僵死进程；进入内核态，忽略kill信号）；</p>
<p>系统管理命令（如查看内存使用、网络情况）；</p>
<p>find命令、awk使用；</p>
<p>Linux下排查某个死循环的线程；</p>
<p>八、网络相关</p>
<p>数据链路层是做什么的?</p>
<p>数据链路层的流量控制？</p>
<p>网络模型的分层、IP和Mac地址在那个层、TCP和HTTP分别在那个层；</p>
<p>TCP滑动窗口；</p>
<p>TCP为什么可靠；</p>
<p>TCP的同传，拆包与组装包是什么意思；</p>
<p>Https和Http有什么区别；</p>
<p>Http 为什么是无状态的；</p>
<p>TCP三次握手，为什么不是三次，为什么不是四次；</p>
<p>TCP的拥塞控制、流量控制详细说明？</p>
<p>Http1.0和Http2.0的区别；</p>
<p>两个不同ip地址的计算机之间如何通信；</p>
<p>地址解析协议ARP；</p>
<p>OSI七层模型分别对应着五层模型的哪一部分；</p>
<p>TCP三次握手数据丢失了怎么办？那如果后面又找到了呢？</p>
<p>九、分布式相关</p>
<p>消息队列使用的场景介绍和作用（应用耦合、异步消息、流量削锋等）；</p>
<p>如何解决消息队列丢失消息和重复消费问题；</p>
<p>Kafka使用过吗，什么是幂等性？怎么保证一致性，持久化怎么做，分区partition的理解，LEO是什么意思，如何保证多个partition之间数据一致性的（ISR机制），为什么Kafka可以这么快（基于磁盘的顺序读写）；</p>
<p>异步队列怎么实现；</p>
<p>你项目的并发是多少？怎么解决高并发问题？单机情况下Tomcat的并发大概是多少，MySQL的并发大致是多少？</p>
<p>什么是C10K问题；</p>
<p>高并发情况下怎么办；</p>
<p>分布式理论，什么是CAP理论，什么是Base理论，什么是Paxos理论；</p>
<p>分布式协议的选举算法；</p>
<p>说一下你对微服务的理解，与SOA的区别；</p>
<p>Dubbo的基本原理，RPC，支持哪些通信方式，服务的调用过程；</p>
<p>Dubbo如果有一个服务挂掉了怎么办；</p>
<p>分布式事务，操作两个表不在一个库，如何保证一致性。</p>
<p>分布式系统中，每台机器如何产生一个唯一的随机值；</p>
<p>系统的量级、pv、uv等；</p>
<p>什么是Hash一致性算法？分布式缓存的一致性，服务器如何扩容（哈希环）；</p>
<p>正向代理、反向代理；</p>
<p>什么是客户端负载均衡策略、什么是服务器端负载均衡策略；</p>
<p>如何优化Tomcat，常见的优化方式有哪些；</p>
<p>Nginx的Master和Worker，Nginx是如何处理请求的；</p>
<p>十、系统设计相关</p>
<p>如何防止表单重复提交（Token令牌环等方式）；</p>
<p>有一个url白名单，需要使用正则表达式进行过滤，但是url量级很大，大概亿级，那么如何优化正则表达式？如何优化亿级的url匹配呢？</p>
<p>常见的Nginx负载均衡策略；已有两台Nginx服务器了，倘若这时候再增加一台服务器，采用什么负载均衡算法比较好？</p>
<p>扫描二维码登录的过程解析；</p>
<p>如何设计一个生成唯一UUID的算法？</p>
<p>实现一个负载均衡的算法，服务器资源分配为70%、20%、10%；</p>
<p>有三个线程T1 T2 T3，如何保证他们按顺序执行；</p>
<p>三个线程循环输出ABCABCABC….</p>
<p>十一、安全相关</p>
<p>什么是XSS攻击，XSS攻击的一般表现形式有哪些？如何防止XSS攻击；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/08/java面试题第一套/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/08/java面试题第一套/" itemprop="url">java面试题第一套</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-08T21:54:34+08:00">
                2018-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="java面试题第一套"><a href="#java面试题第一套" class="headerlink" title="java面试题第一套"></a>java面试题第一套</h3><p>一、基础篇</p>
<p>1.1、Java基础 </p>
<p>面向对象的特征：继承、封装和多态</p>
<p>final, finally, finalize 的区别</p>
<p>Exception、Error、运行时异常与一般异常有何异同</p>
<p>请写出5种常见到的runtime exception</p>
<p>int 和 Integer 有什么区别，Integer的值缓存范围</p>
<p>包装类，装箱和拆箱</p>
<p>String、StringBuilder、StringBuffer</p>
<p>重载和重写的区别</p>
<p>抽象类和接口有什么区别</p>
<p>说说反射的用途及实现</p>
<p>说说自定义注解的场景及实现</p>
<p>HTTP请求的GET与POST方式的区别</p>
<p>Session与Cookie区别</p>
<p>列出自己常用的JDK包</p>
<p>MVC设计思想</p>
<p>equals与==的区别</p>
<p>hashCode和equals方法的区别与联系</p>
<p>什么是Java序列化和反序列化，如何实现Java序列化？或者请解释Serializable 接口的作用</p>
<p>Object类中常见的方法，为什么wait  notify会放在Object里边？</p>
<p>三个方法都必须在synchronized 同步关键字所限定的作用域中调用，否则会报错java.lang.IllegalMonitorStateException ，意思是因为没有同步，所以线程对对象锁的状态是不确定的，不能调用这些方法</p>
<p>Java的平台无关性如何体现出来的</p>
<p>JDK和JRE的区别</p>
<p>Java 8有哪些新特性</p>
<p>1.2、Java常见集合</p>
<p>List 和 Set 区别</p>
<p>Set和hashCode以及equals方法的联系</p>
<p>List 和 Map 区别</p>
<p>Arraylist 与 LinkedList 区别</p>
<p>ArrayList 与 Vector 区别</p>
<p>HashMap 和 Hashtable 的区别</p>
<p>HashSet 和 HashMap 区别</p>
<p>HashMap 和 ConcurrentHashMap 的区别</p>
<p>HashMap 的工作原理及代码实现，什么时候用到红黑树</p>
<p>多线程情况下HashMap死循环的问题</p>
<p>HashMap出现Hash DOS攻击的问题</p>
<p>ConcurrentHashMap 的工作原理及代码实现，如何统计所有的元素个数</p>
<p>手写简单的HashMap</p>
<p>看过那些Java集合类的源码</p>
<p>1.3、进程和线程</p>
<p>线程和进程的概念、并行和并发的概念</p>
<p>创建线程的方式及实现</p>
<p>进程间通信的方式</p>
<p>说说 CountDownLatch、CyclicBarrier 原理和区别</p>
<p>说说 Semaphore 原理</p>
<p>说说 Exchanger 原理</p>
<p>ThreadLocal 原理分析，ThreadLocal为什么会出现OOM，出现的深层次原理</p>
<p>讲讲线程池的实现原理</p>
<p>线程池的几种实现方式</p>
<p>线程的生命周期，状态是如何转移的</p>
<p>可参考：《Java多线程编程核心技术》<br>1.4、锁机制</p>
<p>说说线程安全问题，什么是线程安全，如何保证线程安全</p>
<p>重入锁的概念，重入锁为什么可以防止死锁</p>
<p>产生死锁的四个条件（互斥、请求与保持、不剥夺、循环等待）</p>
<p>如何检查死锁（通过jConsole检查死锁）</p>
<p>volatile 实现原理（禁止指令重排、刷新内存）</p>
<p>synchronized 实现原理（对象监视器）</p>
<p>synchronized 与 lock 的区别</p>
<p>AQS同步队列</p>
<p>CAS无锁的概念、乐观锁和悲观锁</p>
<p>常见的原子操作类</p>
<p>什么是ABA问题，出现ABA问题JDK是如何解决的</p>
<p>乐观锁的业务场景及实现方式</p>
<p>Java 8并法包下常见的并发类</p>
<p>偏向锁、轻量级锁、重量级锁、自旋锁的概念</p>
<p>可参考：《Java多线程编程核心技术》</p>
<p>1.5、JVM</p>
<p>JVM运行时内存区域划分</p>
<p>内存溢出OOM和堆栈溢出SOE的示例及原因、如何排查与解决</p>
<p>如何判断对象是否可以回收或存活</p>
<p>常见的GC回收算法及其含义</p>
<p>常见的JVM性能监控和故障处理工具类：jps、jstat、jmap、jinfo、jconsole等</p>
<p>JVM如何设置参数</p>
<p>JVM性能调优</p>
<p>类加载器、双亲委派模型、一个类的生命周期、类是如何加载到JVM中的</p>
<p>类加载的过程：加载、验证、准备、解析、初始化</p>
<p>强引用、软引用、弱引用、虚引用</p>
<p>Java内存模型JMM</p>
<p>1.6、设计模式</p>
<p>常见的设计模式</p>
<p>设计模式的的六大原则及其含义</p>
<p>常见的单例模式以及各种实现方式的优缺点，哪一种最好，手写常见的单利模式</p>
<p>设计模式在实际场景中的应用</p>
<p>Spring中用到了哪些设计模式</p>
<p>MyBatis中用到了哪些设计模式</p>
<p>你项目中有使用哪些设计模式</p>
<p>说说常用开源框架中设计模式使用分析</p>
<p>动态代理很重要！！！</p>
<p>1.7、数据结构</p>
<p>树（二叉查找树、平衡二叉树、红黑树、B树、B+树）</p>
<p>深度有限算法、广度优先算法</p>
<p>克鲁斯卡尔算法、普林母算法、迪克拉斯算法</p>
<p>什么是一致性Hash及其原理、Hash环问题</p>
<p>常见的排序算法和查找算法：快排、折半查找、堆排序等</p>
<p>1.8、网络/IO基础</p>
<p>BIO、NIO、AIO的概念</p>
<p>什么是长连接和短连接</p>
<p>Http1.0和2.0相比有什么区别，可参考《Http 2.0》</p>
<p>Https的基本概念</p>
<p>三次握手和四次挥手、为什么挥手需要四次</p>
<p>从游览器中输入URL到页面加载的发生了什么？可参考《从输入URL到页面加载发生了什么》</p>
<p>二、数据存储和消息队列</p>
<p>2.1、数据库</p>
<p>MySQL 索引使用的注意事项</p>
<p>DDL、DML、DCL分别指什么</p>
<p>explain命令</p>
<p>left join，right join，inner join</p>
<p>数据库事物ACID（原子性、一致性、隔离性、持久性）</p>
<p>事物的隔离级别（读未提交、读以提交、可重复读、可序列化读）</p>
<p>脏读、幻读、不可重复读</p>
<p>数据库的几大范式</p>
<p>数据库常见的命令</p>
<p>说说分库与分表设计</p>
<p>分库与分表带来的分布式困境与应对之策（如何解决分布式下的分库分表，全局表？）</p>
<p>说说 SQL 优化之道</p>
<p>MySQL遇到的死锁问题、如何排查与解决</p>
<p>存储引擎的 InnoDB与MyISAM区别，优缺点，使用场景</p>
<p>索引类别（B+树索引、全文索引、哈希索引）、索引的原理</p>
<p>什么是自适应哈希索引（AHI）</p>
<p>为什么要用 B+tree作为MySQL索引的数据结构</p>
<p>聚集索引与非聚集索引的区别</p>
<p>遇到过索引失效的情况没，什么时候可能会出现，如何解决</p>
<p>limit 20000 加载很慢怎么解决</p>
<p>如何选择合适的分布式主键方案</p>
<p>选择合适的数据存储方案</p>
<p>常见的几种分布式ID的设计方案</p>
<p>常见的数据库优化方案，在你的项目中数据库如何进行优化的</p>
<p>2.2、Redis</p>
<p>Redis 有哪些数据类型，可参考《Redis常见的5种不同的数据类型详解》</p>
<p>Redis 内部结构</p>
<p>Redis 使用场景</p>
<p>Redis 持久化机制，可参考《使用快照和AOF将Redis数据持久化到硬盘中》</p>
<p>Redis 集群方案与实现</p>
<p>Redis 为什么是单线程的？</p>
<p>缓存雪崩、缓存穿透、缓存预热、缓存更新、缓存降级</p>
<p>使用缓存的合理性问题</p>
<p>Redis常见的回收策略</p>
<p>2.3、消息队列</p>
<p>消息队列的使用场景</p>
<p>消息的重发补偿解决思路</p>
<p>消息的幂等性解决思路</p>
<p>消息的堆积解决思路</p>
<p>自己如何实现消息队列</p>
<p>如何保证消息的有序性</p>
<p>三、开源框架和容器</p>
<p>3.1、SSM/Servlet</p>
<p>Servlet的生命周期</p>
<p>转发与重定向的区别</p>
<p>BeanFactory 和 ApplicationContext 有什么区别</p>
<p>Spring Bean 的生命周期</p>
<p>Spring IOC 如何实现</p>
<p>Spring中Bean的作用域，默认的是哪一个</p>
<p>说说 Spring AOP、Spring AOP 实现原理</p>
<p>动态代理（CGLib 与 JDK）、优缺点、性能对比、如何选择</p>
<p>Spring 事务实现方式、事务的传播机制、默认的事务类别</p>
<p>Spring 事务底层原理</p>
<p>Spring事务失效（事务嵌套），JDK动态代理给Spring事务埋下的坑，可参考《JDK动态代理给Spring事务埋下的坑！》</p>
<p>如何自定义注解实现功能</p>
<p>Spring MVC 运行流程</p>
<p>Spring MVC 启动流程</p>
<p>Spring 的单例实现原理</p>
<p>Spring 框架中用到了哪些设计模式</p>
<p>Spring 其他产品（Srping Boot、Spring Cloud、Spring Secuirity、Spring Data、Spring AMQP 等）</p>
<p>有没有用到Spring Boot，Spring Boot的认识、原理</p>
<p>MyBatis的原理</p>
<p>可参考《为什么会有Spring》</p>
<p>可参考《为什么会有Spring AOP》</p>
<p>3.2、Netty</p>
<p>为什么选择 Netty</p>
<p>说说业务中，Netty 的使用场景</p>
<p>原生的 NIO 在 JDK 1.7 版本存在 epoll bug</p>
<p>什么是TCP 粘包/拆包</p>
<p>TCP粘包/拆包的解决办法</p>
<p>Netty 线程模型</p>
<p>说说 Netty 的零拷贝</p>
<p>Netty 内部执行流程</p>
<p>Netty 重连实现</p>
<p>3.3、Tomcat</p>
<p>Tomcat的基础架构（Server、Service、Connector、Container）</p>
<p>Tomcat如何加载Servlet的</p>
<p>Pipeline-Valve机制</p>
<p>可参考：《四张图带你了解Tomcat系统架构！》</p>
<p>四、分布式</p>
<p>4.1、Nginx</p>
<p>请解释什么是C10K问题或者知道什么是C10K问题吗？</p>
<p>Nginx简介，可参考《Nginx简介》</p>
<p>正向代理和反向代理.</p>
<p>Nginx几种常见的负载均衡策略</p>
<p>Nginx服务器上的Master和Worker进程分别是什么</p>
<p>使用“反向代理服务器”的优点是什么?</p>
<p>4.2、分布式其他</p>
<p>谈谈业务中使用分布式的场景</p>
<p>Session 分布式方案</p>
<p>Session 分布式处理</p>
<p>分布式锁的应用场景、分布式锁的产生原因、基本概念</p>
<p>分布是锁的常见解决方案</p>
<p>分布式事务的常见解决方案</p>
<p>集群与负载均衡的算法与实现</p>
<p>说说分库与分表设计，可参考《数据库分库分表策略的具体实现方案》</p>
<p>分库与分表带来的分布式困境与应对之策</p>
<p>4.3、Dubbo</p>
<p>什么是Dubbo，可参考《Dubbo入门》</p>
<p>什么是RPC、如何实现RPC、RPC 的实现原理，可参考《基于HTTP的RPC实现》</p>
<p>Dubbo中的SPI是什么概念</p>
<p>Dubbo的基本原理、执行流程</p>
<p>五、微服务</p>
<p>5.1、微服务</p>
<p>前后端分离是如何做的？</p>
<p>微服务哪些框架</p>
<p>Spring Could的常见组件有哪些？可参考《Spring Cloud概述》</p>
<p>领域驱动有了解吗？什么是领域驱动模型？充血模型、贫血模型</p>
<p>JWT有了解吗，什么是JWT，可参考《前后端分离利器之JWT》</p>
<p>你怎么理解 RESTful</p>
<p>说说如何设计一个良好的 API</p>
<p>如何理解 RESTful API 的幂等性</p>
<p>如何保证接口的幂等性</p>
<p>说说 CAP 定理、BASE 理论</p>
<p>怎么考虑数据一致性问题</p>
<p>说说最终一致性的实现方案</p>
<p>微服务的优缺点，可参考《微服务批判》</p>
<p>微服务与 SOA 的区别</p>
<p>如何拆分服务、水平分割、垂直分割</p>
<p>如何应对微服务的链式调用异常</p>
<p>如何快速追踪与定位问题</p>
<p>如何保证微服务的安全、认证</p>
<p>5.2、安全问题</p>
<p>如何防范常见的Web攻击、如何方式SQL注入</p>
<p>服务端通信安全攻防</p>
<p>HTTPS原理剖析、降级攻击、HTTP与HTTPS的对比</p>
<p>5.3、性能优化</p>
<p>性能指标有哪些</p>
<p>如何发现性能瓶颈</p>
<p>性能调优的常见手段</p>
<p>说说你在项目中如何进行性能调优</p>
<p>六、其他</p>
<p>6.1、设计能力</p>
<p>说说你在项目中使用过的UML图</p>
<p>你如何考虑组件化、服务化、系统拆分</p>
<p>秒杀场景如何设计</p>
<p>可参考：《秒杀系统的技术挑战、应对策略以及架构设计总结一二！》<br>6.2、业务工程</p>
<p>说说你的开发流程、如何进行自动化部署的</p>
<p>你和团队是如何沟通的</p>
<p>你如何进行代码评审</p>
<p>说说你对技术与业务的理解</p>
<p>说说你在项目中遇到感觉最难Bug，是如何解决的</p>
<p>介绍一下工作中的一个你认为最有价值的项目，以及在这个过程中的角色、解决的问题、你觉得你们项目还有哪些不足的地方</p>
<p>6.3、软实力</p>
<p>说说你的优缺点、亮点</p>
<p>说说你最近在看什么书、什么博客、在研究什么新技术、再看那些开源项目的源代码</p>
<p>说说你觉得最有意义的技术书籍</p>
<p>工作之余做什么事情、平时是如何学习的，怎样提升自己的能力</p>
<p>说说个人发展方向方面的思考</p>
<p>说说你认为的服务端开发工程师应该具备哪些能力</p>
<p>说说你认为的架构师是什么样的，架构师主要做什么</p>
<p>如何看待加班的问题</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/06/队列/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/06/队列/" itemprop="url">队列</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-06T10:26:52+08:00">
                2018-07-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h3><h4 id="BlockingQueue-阻塞队列"><a href="#BlockingQueue-阻塞队列" class="headerlink" title="BlockingQueue 阻塞队列"></a>BlockingQueue 阻塞队列</h4><p>当一个线程试图对一个已经满了的队列进行入队列操作时，它将会被阻塞，除非有另一个线程做了出队列操作；同样，当一个线程试图对一个空队列进行出队列操作时，它将会被阻塞，除非有另一个线程进行了入队列操作，阻塞队列是线程安全的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BlockingQueue</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">add</span><span class="params">(E e)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E e)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(E e)</span> <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line">	<span class="function"><span class="keyword">boolean</span> <span class="title">offer</span><span class="params">(E e, <span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line">   <span class="function">E <span class="title">take</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line">   <span class="function">E <span class="title">poll</span><span class="params">(<span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException</span>;</span><br><span class="line">   <span class="function"><span class="keyword">boolean</span> <span class="title">remove</span><span class="params">(Object o)</span></span>;<span class="comment">//获取并移除表头元素</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Queue</span>&lt;<span class="title">E</span>&gt; <span class="keyword">extends</span> <span class="title">Collection</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function">E <span class="title">poll</span><span class="params">()</span></span>;<span class="comment">//获取并移除表头元素</span></span><br><span class="line">   <span class="function">E <span class="title">element</span><span class="params">()</span></span>;<span class="comment">//获取表头元素，不移除</span></span><br><span class="line">   <span class="function">E <span class="title">peek</span><span class="params">()</span></span>;<span class="comment">//获取表头元素，不移除</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>-</th>
<th>Throws Exception</th>
<th>Special Value</th>
<th>Blocks</th>
<th>Times Out</th>
</tr>
</thead>
<tbody>
<tr>
<td>Insert</td>
<td>add(o)</td>
<td>offer(o) 返回true or false</td>
<td>put(o)</td>
<td>offer(o, timeout, timeunit)</td>
</tr>
<tr>
<td>Remove</td>
<td>remove(o)</td>
<td>poll() 返回null</td>
<td>take()</td>
<td>poll(timeout, timeunit)</td>
</tr>
<tr>
<td>Examine</td>
<td>element()</td>
<td>peek() 返回null</td>
<td></td>
</tr>
</tbody>
</table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. ThrowsException：如果操作不能马上进行，则抛出异常</span><br><span class="line"><span class="number">2</span>. SpecialValue：如果操作不能马上进行，将会返回一个特殊的值，一般是<span class="keyword">true</span>或者<span class="keyword">false</span></span><br><span class="line"><span class="number">3</span>. Blocks:如果操作不能马上进行，操作会被阻塞</span><br><span class="line"><span class="number">4</span>. TimesOut:如果操作不能马上进行，操作会被阻塞指定的时间，如果指定时间没执行，则返回一个特殊值，一般是<span class="keyword">true</span>或者<span class="keyword">false</span></span><br><span class="line"></span><br><span class="line">需要注意的是，我们不能向BlockingQueue中插入<span class="keyword">null</span>，否则会报NullPointerException。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://killgc.github.io/shortfeng/shortfeng/2018/07/05/线程池/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="changfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/shortfeng/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/shortfeng/2018/07/05/线程池/" itemprop="url">线程池</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-05T00:26:18+08:00">
                2018-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="线程池"><a href="#线程池" class="headerlink" title="线程池"></a>线程池</h3><p>Java中的线程池类有两个，分别是：ThreadPoolExecutor和ScheduledThreadPoolExecutor，这两个类都继承自ExecutorService。利用这两个类，可以创建各种不同的Java线程池，为了方便我们创建线程池，Java API提供了Executors工厂类来帮助我们创建各种各样的线程池。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ThreadPoolExecutor</span> <span class="keyword">extends</span> <span class="title">AbstractExecutorService</span></span></span><br><span class="line"><span class="class">        </span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">abstract</span> <span class="title">class</span> <span class="title">AbstractExecutorService</span> <span class="keyword">implements</span> <span class="title">ExecutorService</span>              </span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">ExecutorService</span> <span class="keyword">extends</span> <span class="title">Executor</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">Executor</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">execute</span><span class="params">(Runnable command)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScheduledThreadPoolExecutor</span></span></span><br><span class="line"><span class="class">        <span class="keyword">extends</span> <span class="title">ThreadPoolExecutor</span></span></span><br><span class="line"><span class="class">        <span class="keyword">implements</span> <span class="title">ScheduledExecutorService</span></span></span><br><span class="line"><span class="class">        </span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">ScheduledExecutorService</span> <span class="keyword">extends</span> <span class="title">ExecutorService</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> ScheduledFuture&lt;?&gt; schedule(Runnable command,</span><br><span class="line">                                       <span class="keyword">long</span> delay, TimeUnit unit);</span><br><span class="line">                                       </span><br><span class="line">   <span class="keyword">public</span> &lt;V&gt; <span class="function">ScheduledFuture&lt;V&gt; <span class="title">schedule</span><span class="params">(Callable&lt;V&gt; callable,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           <span class="keyword">long</span> delay, TimeUnit unit)</span></span>;</span><br><span class="line">                                           </span><br><span class="line">   <span class="keyword">public</span> ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,</span><br><span class="line">                                                  <span class="keyword">long</span> initialDelay,</span><br><span class="line">                                                  <span class="keyword">long</span> period,</span><br><span class="line">                                                  TimeUnit unit);</span><br><span class="line">                                                  </span><br><span class="line">   <span class="keyword">public</span> ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,</span><br><span class="line">                                                     <span class="keyword">long</span> initialDelay,</span><br><span class="line">                                                     <span class="keyword">long</span> delay,</span><br><span class="line">                                                     TimeUnit unit);                                                                                                                          </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1、ThreadPoolExecutor</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                              <span class="keyword">int</span> maximumPoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                              <span class="keyword">long</span> keepAliveTime,</span></span></span><br><span class="line"><span class="function"><span class="params">                              TimeUnit unit,</span></span></span><br><span class="line"><span class="function"><span class="params">                              BlockingQueue&lt;Runnable&gt; workQueue)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,</span><br><span class="line">             Executors.defaultThreadFactory(), defaultHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- corePoolSize：线程池维护线程的最少数量</span><br><span class="line">- maximumPoolSize：线程池维护线程的最大数量</span><br><span class="line">- keepAliveTime： 线程池维护线程所允许的空闲时间</span><br><span class="line">- unit： 线程池维护线程所允许的空闲时间的单位</span><br><span class="line">- workQueue： 线程池所使用的缓冲队列</span><br><span class="line">- handler： 线程池对拒绝任务的处理策略</span><br><span class="line"></span><br><span class="line">线程数量控制：</span><br><span class="line"><span class="number">1</span>. 如果此时线程池中的数量小于corePoolSize，即使线程池中的线程都处于空闲状态，也要创建新的线程来处理被添加的任务。</span><br><span class="line"><span class="number">2</span>. 如果此时线程池中的数量等于 corePoolSize，但是缓冲队列 workQueue未满，那么任务被放入缓冲队列。</span><br><span class="line"><span class="number">3</span>. 如果此时线程池中的数量大于corePoolSize，缓冲队列workQueue满，并且线程池中的数量小于maximumPoolSize，建新的线程来处理被添加的任务。</span><br><span class="line"><span class="number">4</span>. 如果此时线程池中的数量大于corePoolSize，缓冲队列workQueue满，并且线程池中的数量等于maximumPoolSize，那么通过 handler所指定的策略来处理此任务。也就是：处理任务的优先级为：核心线程corePoolSize、任务队列workQueue、最大线程maximumPoolSize，如果三者都满了，使用handler处理被拒绝的任务。</span><br><span class="line"><span class="number">5</span>. 当线程池中的线程数量大于 corePoolSize时，如果某线程空闲时间超过keepAliveTime，线程将被终止。</span><br><span class="line"></span><br><span class="line">unit 可选的参数为java.util.concurrent.TimeUnit中的几个静态属性：</span><br><span class="line">- NANOSECONDS</span><br><span class="line">- MICROSECONDS</span><br><span class="line">- MILLISECONDS</span><br><span class="line">- SECONDS</span><br><span class="line"></span><br><span class="line">workQueue：</span><br><span class="line">workQueue是一个BlockingQueue，默认是LinkedBlockingQueue&lt;Runnable&gt;</span><br><span class="line"></span><br><span class="line">handler 是线程池拒绝处理任务的方式，主要有四种类型：</span><br><span class="line">ThreadPoolExecutor.AbortPolicy()（系统默认）：抛出java.util.concurrent.RejectedExecutionException异常</span><br><span class="line">ThreadPoolExecutor.CallerRunsPolicy()：当抛出RejectedExecutionException异常时，会调用rejectedExecution方法</span><br><span class="line">ThreadPoolExecutor.DiscardOldestPolicy()：抛弃旧的任务</span><br><span class="line">ThreadPoolExecutor.DiscardPolicy()：抛弃当前的任务</span><br></pre></td></tr></table></figure>
<p>2、ScheduledThreadPoolExecutor</p>
<p>最主要的功能就是可以对其中的任务进行调度，比如延迟执行、定时执行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ScheduledExecutorService</span> <span class="keyword">extends</span> <span class="title">ExecutorService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ScheduledFuture&lt;?&gt; schedule(Runnable command, <span class="keyword">long</span> delay, TimeUnit unit);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> &lt;V&gt; <span class="function">ScheduledFuture&lt;V&gt; <span class="title">schedule</span><span class="params">(Callable&lt;V&gt; callable,</span></span></span><br><span class="line"><span class="function"><span class="params">                                           <span class="keyword">long</span> delay, TimeUnit unit)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ScheduledFuture&lt;?&gt; scheduleAtFixedRate(Runnable command,<span class="keyword">long</span> initialDelay, <span class="keyword">long</span> period, TimeUnit unit);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ScheduledFuture&lt;?&gt; scheduleWithFixedDelay(Runnable command,<span class="keyword">long</span> initialDelay, <span class="keyword">long</span> delay,TimeUnit unit);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>、schedule (Callable task, <span class="keyword">long</span> delay, TimeUnit timeunit)</span><br><span class="line">这个方法与schedule (Runnable task)类似，也是在指定延迟之后运行task，不过它接收的是一个Callable实例，此方法会返回一个ScheduleFuture对象，通过ScheduleFuture我们可以取消一个未执行的task，也可以获得这个task的执行结果。</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、scheduleAtFixedRate (Runnable, <span class="keyword">long</span> initialDelay, <span class="keyword">long</span> period, TimeUnit timeunit)</span><br><span class="line">这个方法的作用是周期性的调度task执行。task第一次执行的延迟根据initialDelay参数确定，以后每一次执行都间隔period时长。</span><br><span class="line"></span><br><span class="line">如果task的执行时间大于定义的period，那么下一个线程将在当前线程完成之后再执行。整个调度保证不会出现一个以上任务同时执行。</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>、scheduleWithFixedDelay (Runnable, <span class="keyword">long</span> initialDelay, <span class="keyword">long</span> period, TimeUnit timeunit)</span><br><span class="line">scheduleWithFixedDelay的参数和scheduleAtFixedRate参数完全一致，它们的不同之处在于对period调度周期的解释。</span><br><span class="line"></span><br><span class="line">在scheduleAtFixedRate中，period指的两个任务开始执行的时间间隔，也就是当前任务的开始执行时间和下个任务的开始执行时间之间的间隔。</span><br><span class="line"></span><br><span class="line">而在scheduleWithFixedDelay中，period指的当前任务的结束执行时间到下个任务的开始执行时间。</span><br><span class="line"></span><br><span class="line"><span class="number">4</span>、ScheduledExecutorService的关闭</span><br><span class="line">和ExecutorService类似, 我们在使用完ScheduledExecutorService时需要关闭它。如果不关闭的话，JVM会一直运行直，即使所有线程已经关闭了。</span><br><span class="line"></span><br><span class="line">关闭ScheduledExecutorService可以使用其继承自ExecutorService接口的shutdown()和shutdownNow()方法，两者的区别请参考</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ScheduledThreadPoolExecutor继承自ThreadPoolExecutor，构造参数很简单，只有<span class="number">3</span>个：</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ScheduledThreadPoolExecutor</span><span class="params">(<span class="keyword">int</span> corePoolSize,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       ThreadFactory threadFactory,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       RejectedExecutionHandler handler)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(corePoolSize, Integer.MAX_VALUE, <span class="number">0</span>, NANOSECONDS,</span><br><span class="line">              <span class="keyword">new</span> DelayedWorkQueue(), threadFactory, handler);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>3、Executors</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Executors</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                      <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                      <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newFixedThreadPool</span><span class="params">(<span class="keyword">int</span> nThreads, ThreadFactory threadFactory)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(nThreads, nThreads,</span><br><span class="line">                                      <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                      <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;(),</span><br><span class="line">                                      threadFactory);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newSingleThreadExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> FinalizableDelegatedExecutorService</span><br><span class="line">            (<span class="keyword">new</span> ThreadPoolExecutor(<span class="number">1</span>, <span class="number">1</span>,</span><br><span class="line">                                    <span class="number">0L</span>, TimeUnit.MILLISECONDS,</span><br><span class="line">                                    <span class="keyword">new</span> LinkedBlockingQueue&lt;Runnable&gt;()));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ExecutorService <span class="title">newCachedThreadPool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ThreadPoolExecutor(<span class="number">0</span>, Integer.MAX_VALUE,</span><br><span class="line">                                      <span class="number">60L</span>, TimeUnit.SECONDS,</span><br><span class="line">                                      <span class="keyword">new</span> SynchronousQueue&lt;Runnable&gt;());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ScheduledExecutorService <span class="title">newSingleThreadScheduledExecutor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DelegatedScheduledExecutorService</span><br><span class="line">            (<span class="keyword">new</span> ScheduledThreadPoolExecutor(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. newCachedThreadPool 创建一个可缓存线程池，如果线程池长度超过处理需要，可灵活回收空闲线程，若无可回收，则新建线程。</span><br><span class="line"><span class="number">2</span>. newFixedThreadPool 创建一个定长线程池，可控制线程最大并发数，超出的线程会在队列中等待。</span><br><span class="line"><span class="number">3</span>. newScheduledThreadPool 创建一个定长线程池，支持定时及周期性任务执行。</span><br><span class="line"><span class="number">4</span>. newSingleThreadExecutor 创建一个单线程化的线程池，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序(FIFO, LIFO, 优先级)执行。</span><br></pre></td></tr></table></figure>
<p>创建一个什么样的ExecutorService的实例（即线程池）需要我们的具体应用场景而定，不过Java给我们提供了一个Executors工厂类，它可以帮助我们很方便的创建各种类型ExecutorService线程池，Executors一共可以创建下面这四类线程池</p>
<p>备注：Executors只是一个工厂类，它所有的方法返回的都是ThreadPoolExecutor、ScheduledThreadPoolExecutor这两个类的实例。</p>
<p>4、ExecutorService接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ExecutorService</span> <span class="keyword">extends</span> <span class="title">Executor</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">shutdown</span><span class="params">()</span></span>;</span><br><span class="line">	&lt;T&gt; <span class="function">Future&lt;T&gt; <span class="title">submit</span><span class="params">(Callable&lt;T&gt; task)</span></span>;</span><br><span class="line">	&lt;T&gt; <span class="function">Future&lt;T&gt; <span class="title">submit</span><span class="params">(Runnable task, T result)</span></span>;</span><br><span class="line">	Future&lt;?&gt; submit(Runnable task);</span><br><span class="line">   &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line">   &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span><br><span class="line">                                  <span class="keyword">long</span> timeout, TimeUnit unit)</span><br><span class="line">        <span class="keyword">throws</span> InterruptedException;</span><br><span class="line">   &lt;T&gt; <span class="function">T <span class="title">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException, ExecutionException</span>;</span><br><span class="line">   &lt;T&gt; <span class="function">T <span class="title">invokeAny</span><span class="params">(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks,</span></span></span><br><span class="line"><span class="function"><span class="params">                    <span class="keyword">long</span> timeout, TimeUnit unit)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutException</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">submit(Runnable)和execute(Runnable)区别是前者可以返回一个Future对象，通过返回的Future对象，我们可以检查提交的任务是否执行完毕</span><br><span class="line">   </span><br><span class="line">   submit(Callable)和submit(Runnable)类似，也会返回一个Future对象，但是除此之外，submit(Callable)接收的是一个Callable的实现，Callable接口中的call()方法有一个返回值，可以返回任务的执行结果，而Runnable接口中的run()方法是<span class="keyword">void</span>的，没有返回值</span><br><span class="line">   </span><br><span class="line">   invokeAny(...)方法接收的是一个Callable的集合，执行这个方法不会返回Future，但是会返回所有Callable任务中其中一个任务的执行结果。这个方法也无法保证返回的是哪个任务的执行结果，反正是其中的某一个</span><br><span class="line">   </span><br><span class="line">   invokeAll(...)与 invokeAny(...)类似也是接收一个Callable集合，但是前者执行之后会返回一个Future的List，其中对应着每个Callable任务执行后的Future对象</span><br><span class="line">   </span><br><span class="line">   ExecutorService.shutdown()方法。在调用shutdown()方法之后，ExecutorService不会立即关闭，但是它不再接收新的任务，直到当前所有线程执行完成才会关闭，所有在shutdown()执行之前提交的任务都会被执行</span><br><span class="line">   </span><br><span class="line">   如果我们想立即关闭ExecutorService，我们可以调用ExecutorService.shutdownNow()方法。这个动作将跳过所有正在执行的任务和被提交还没有执行的任务。但是它并不对正在执行的任务做任何保证，有可能它们都会停止，也有可能执行完成。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Future future = executorService.submit(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Asynchronous task"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">future.get();  <span class="comment">//returns null if the task has finished correctly.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Future future = executorService.submit(<span class="keyword">new</span> Callable()&#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    System.out.println(<span class="string">"Asynchronous Callable"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"Callable Result"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">"future.get() = "</span> + future.get());</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/shortfeng/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/shortfeng/page/5/">5</a><a class="extend next" rel="next" href="/shortfeng/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/shortfeng/images/avatar.gif"
               alt="changfeng" />
          <p class="site-author-name" itemprop="name">changfeng</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/shortfeng/archives/">
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">changfeng</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/shortfeng/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/shortfeng/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/shortfeng/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/shortfeng/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/shortfeng/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/shortfeng/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/shortfeng/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/shortfeng/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/shortfeng/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/shortfeng/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/shortfeng/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
